"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[72],{6572:(e,n,s)=>{s.d(n,{A:()=>r});const r="data:image/png;base64,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"},7207:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image2-6275f67f41230997ea1aba754884f15f.png"},7479:e=>{e.exports=JSON.parse('{"permalink":"/test-github-pages/blog/2025/05/16/deployer-une-application-react-asp-net-core-cosmosdb-azure","source":"@site/blog/2025-05-16-deployer-une-application-react-asp-net-core-cosmosdb-azure.md","title":"D\xe9ployer une application React + ASP.NET Core + Cosmos DB sur Azure : gestion des environnements et des secrets","description":"Dans cet article, je partage mon exp\xe9rience de d\xe9ploiement de RentCRL sur Azure. Cette application comprend :","date":"2025-05-16T00:00:00.000Z","tags":[],"readingTime":7.56,"hasTruncateMarker":true,"authors":[{"name":"Micka\xebl C\xe9raline","title":"D\xe9veloppeur Full Stack","url":"https://github.com/mickaelcrl","key":"mickael","page":null}],"frontMatter":{"title":"D\xe9ployer une application React + ASP.NET Core + Cosmos DB sur Azure : gestion des environnements et des secrets","authors":"mickael","date":"2025-05-16T00:00:00.000Z"},"unlisted":false,"nextItem":{"title":"rentcrl-domain-driven-design-minimal-api","permalink":"/test-github-pages/blog/2025/04/14/rentcrl-domain-driven-design-minimal-api"}}')},7537:(e,n,s)=>{s.d(n,{A:()=>r});const r="data:image/png;base64,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"},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var r=s(6540);const a={},i=r.createContext(a);function t(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),r.createElement(i.Provider,{value:n},e.children)}},8620:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>c});var r=s(7479),a=s(4848),i=s(8453);const t={title:"D\xe9ployer une application React + ASP.NET Core + Cosmos DB sur Azure : gestion des environnements et des secrets",authors:"mickael",date:new Date("2025-05-16T00:00:00.000Z")},l=void 0,o={authorsImageUrls:[void 0]},c=[{value:"1. D\xe9veloppement en local",id:"1-d\xe9veloppement-en-local",level:2},{value:"1.1. Communication avec l\u2019API",id:"11-communication-avec-lapi",level:3},{value:"1.2. Communication entre l\u2019application et la base de donn\xe9es",id:"12-communication-entre-lapplication-et-la-base-de-donn\xe9es",level:3},{value:"2. Pr\xe9paration d\u2019Azure",id:"2-pr\xe9paration-dazure",level:2},{value:"3. D\xe9ploiement de l\u2019API sur Azure",id:"3-d\xe9ploiement-de-lapi-sur-azure",level:2},{value:"4. Deploiement de l\u2019app sur Azure",id:"4-deploiement-de-lapp-sur-azure",level:2},{value:"env.js",id:"envjs",level:3},{value:"env.template.js",id:"envtemplatejs",level:3},{value:"\xc0 quoi \xe7a sert ?",id:"\xe0-quoi-\xe7a-sert-",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"Dans cet article, je partage mon exp\xe9rience de d\xe9ploiement de RentCRL sur Azure. Cette application comprend :"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"une application React"}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"une API REST construite avec ASP.NET Core"}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"une base de donn\xe9es Azure Cosmos DB"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:'Mon objectif principal est de montrer comment je suis pass\xe9 de l\u2019environnement local "Development" \xe0 l\u2019environnement "Staging" et de rendre RentCRL accessible \xe0 tout le monde..'}),"\n",(0,a.jsx)(n.h2,{id:"1-d\xe9veloppement-en-local",children:"1. D\xe9veloppement en local"}),"\n",(0,a.jsx)(n.h3,{id:"11-communication-avec-lapi",children:"1.1. Communication avec l\u2019API"}),"\n",(0,a.jsxs)(n.p,{children:["En local, il est facile de connecter le tout. Le frontend appelle l\u2019API via un ",(0,a.jsx)(n.code,{children:"fetch"})," avec le token d'Auth0 sur le bon endpoint. Dans mon cas, l\u2019API permet juste de cr\xe9er un owner, alors je me rends sur ",(0,a.jsx)(n.code,{children:"apiBaseUrl/owners"}),", o\xf9 ",(0,a.jsx)(n.code,{children:"apiBaseUrl"})," \xe9quivaut \xe0 ",(0,a.jsx)(n.code,{children:"http://localhost:5047"})," pour le moment. Au d\xe9part, j\u2019enregistre la variable dans un fichier ",(0,a.jsx)(n.code,{children:".env"}),", ce qui donne :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:'const token = await getAccessTokenSilently();\nawait fetch(`${import.meta.env.VITE_API_BASE_URL}/owners`, {\n  method: "POST",\n  headers: {\n    "Content-Type": "application/json",\n    Authorization: `Bearer ${token}`,\n  },\n  body: JSON.stringify({ ...owner }),\n});\n'})}),"\n",(0,a.jsx)(n.h3,{id:"12-communication-entre-lapplication-et-la-base-de-donn\xe9es",children:"1.2. Communication entre l\u2019application et la base de donn\xe9es"}),"\n",(0,a.jsx)(n.p,{children:"Ensuite, l\u2019API r\xe9cup\xe8re les informations puis cr\xe9e le owner dans la base de donn\xe9es."}),"\n",(0,a.jsxs)(n.p,{children:["Cependant, l\u2019API a besoin d\u2019accepter les politiques de CORS provenant de l\u2019application et de se connecter \xe0 la base de donn\xe9es pour effectuer les actions. Je configure cela dans le fichier ",(0,a.jsx)(n.code,{children:"Program.cs"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Voici le code pour accepter les politiques de CORS :"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'builder.Services.AddCors(options =>\n{\n    options.AddPolicy(name: MyAllowSpecificOrigins,\n                      policy =>\n                      {\n                          policy.WithOrigins(builder.Configuration["AppBaseUrl"])\n                          .AllowAnyHeader()\n                          .AllowAnyMethod()\n                          .AllowCredentials();\n                      });\n});\n'})}),"\n",(0,a.jsx)(n.p,{children:"Et voici le code pour se connecter \xe0 la base de donn\xe9es :"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:' public static void AddDatabaseConnection(WebApplicationBuilder builder, IServiceCollection services)\n {\n     var endpoint = builder.Configuration["CosmosDB:EndpointUri"];\n     var primaryKey = builder.Configuration["CosmosDB:PrimaryKey"];\n     var database = builder.Configuration["CosmosDB:DatabaseName"];\n     services.AddSingleton(new CosmosDbService(endpoint, primaryKey, database));\n }\n'})}),"\n",(0,a.jsx)(n.p,{children:"L\u2019API a besoin de param\xe8tres de configuration : le base URL de l\u2019application, l\u2019endpoint de la base de donn\xe9es, la cl\xe9 primaire et le nom de la base de donn\xe9es."}),"\n",(0,a.jsxs)(n.p,{children:["Dans le fichier ",(0,a.jsx)(n.code,{children:"appsettings.json"}),", je peux ajouter le base URL de l\u2019application."]}),"\n",(0,a.jsxs)(n.p,{children:["Pour la base de donn\xe9es, en lan\xe7ant l\u2019\xe9mulateur de Cosmos DB, je peux r\xe9cup\xe9rer les informations n\xe9cessaires et les mettre directement dans le fichier ",(0,a.jsx)(n.code,{children:"appsettings.json"})," :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'{\n  "CosmosDB": {\n    "EndpointUri": "https://localhost:8081",\n    "PrimaryKey": "C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==",\n    "DatabaseName": "RentCRLDatabase"\n  },\n\n  "AppBaseUrl": "http://localhost:5173"\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"C\u2019est bon, tout est maintenant connect\xe9 : l\u2019application peut envoyer une requ\xeate \xe0 l\u2019API pour cr\xe9er un owner, l\u2019API peut l\u2019accepter puis se connecter \xe0 la base de donn\xe9es et cr\xe9er le owner."}),"\n",(0,a.jsx)(n.p,{children:"Maintenant, comment faire pour que la configuration fonctionne \xe9galement dans le monde r\xe9el et comment le faire proprement ?"}),"\n",(0,a.jsx)(n.p,{children:"Voyons comment j\u2019ai proc\xe9d\xe9."}),"\n",(0,a.jsx)(n.p,{children:'En local, l\u2019environnement est celui de "Development" : tout tourne sur ma machine. Or, je veux aller en production ou, du moins pour le moment, en "Staging" (pr\xe9-prod). C\u2019est-\xe0-dire que je veux rendre l\u2019application accessible \xe0 tous, et pour cela, j\u2019ai choisi d\u2019utiliser une solution serverless propos\xe9e par Azure : les Container Apps. Ainsi, les trois entit\xe9s (application, API et Cosmos DB) ne tourneront plus sur ma machine, donc l\u2019environnement change, tout comme les variables de configuration que j\u2019ai mentionn\xe9es plus t\xf4t. Voici comment j\u2019ai adapt\xe9 mes variables en fonction de l\u2019environnement.'}),"\n",(0,a.jsx)(n.h2,{id:"2-pr\xe9paration-dazure",children:"2. Pr\xe9paration d\u2019Azure"}),"\n",(0,a.jsxs)(n.p,{children:["D\u2019abord, je me suis rendu sur Azure et j\u2019ai cr\xe9\xe9 une base de donn\xe9es Cosmos DB : ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/cosmos-db/nosql/quickstart-portal",children:"https://learn.microsoft.com/en-us/azure/cosmos-db/nosql/quickstart-portal"})]}),"\n",(0,a.jsxs)(n.p,{children:["Ensuite, j\u2019ai cr\xe9\xe9 deux Container Apps : un pour faire tourner l\u2019image de mon API et l\u2019autre pour faire tourner l\u2019image de mon application : ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/container-apps/quickstart-portal",children:"https://learn.microsoft.com/en-us/azure/container-apps/quickstart-portal"})]}),"\n",(0,a.jsxs)(n.p,{children:["Puis, j\u2019ai cr\xe9\xe9 un Container Registry pour pousser les images de mon application et de mon API, qui seront r\xe9cup\xe9r\xe9es par les Container Apps : ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/container-registry/container-registry-get-started-portal?tabs=azure-cli",children:"https://learn.microsoft.com/en-us/azure/container-registry/container-registry-get-started-portal?tabs=azure-cli"})]}),"\n",(0,a.jsx)(n.h2,{id:"3-d\xe9ploiement-de-lapi-sur-azure",children:"3. D\xe9ploiement de l\u2019API sur Azure"}),"\n",(0,a.jsxs)(n.p,{children:["ASP.NET g\xe8re les variables d\u2019environnement automatiquement lors du lancement de l\u2019application. Comme je l\u2019ai montr\xe9 plus t\xf4t, gr\xe2ce au fichier ",(0,a.jsx)(n.code,{children:"appsettings.json"}),", je peux acc\xe9der aux variables de configuration. Maintenant, il suffit de s\xe9parer les variables qui changent en fonction de l\u2019environnement dans les ",(0,a.jsx)(n.code,{children:"appsettings"})," correspondants."]}),"\n",(0,a.jsxs)(n.p,{children:["Je peux donc cr\xe9er les fichiers ",(0,a.jsx)(n.code,{children:"appsettings.Development.json"})," et ",(0,a.jsx)(n.code,{children:"appsettings.Staging.json"}),"."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image.png",src:s(7537).A+"",width:"378",height:"78"})}),"\n",(0,a.jsxs)(n.p,{children:["Je d\xe9place alors le code dans ",(0,a.jsx)(n.code,{children:"appsettings.Development.json"})," :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:' "CosmosDB": {\n   "EndpointUri": "https://localhost:8081",\n   "PrimaryKey": "C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==",\n   "DatabaseName": "RentCRLDatabase"\n },\n\n "AppBaseUrl": "http://localhost:5173"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Puis, dans ",(0,a.jsx)(n.code,{children:"appsettings.Staging.json"}),", j\u2019ajoute :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'{\n  "CosmosDB": {\n    "EndpointUri": "le endpoint uri de ta bd",\n    "DatabaseName": "RentCRLDatabase"\n  },\n\n  "AppBaseUrl": "le base url du container app qui tourne sur l\'image de ton app (frontend)"\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Dans le ",(0,a.jsx)(n.code,{children:"appsettings.Staging.json"}),", je ne mets pas la cl\xe9 primaire car elle est secr\xe8te. J\u2019utilise le Key Vault d\u2019Azure qui me permet de g\xe9rer mes secrets, car ceux-ci ne doivent pas \xeatre expos\xe9s : ",(0,a.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/container-apps/manage-secrets?tabs=azure-portal",children:"https://learn.microsoft.com/en-us/azure/container-apps/manage-secrets?tabs=azure-portal"})]}),"\n",(0,a.jsxs)(n.p,{children:["Maintenant, gr\xe2ce \xe0 la variable ",(0,a.jsx)(n.code,{children:"ASPNETCORE_ENVIRONMENT"}),', si la valeur est "Development", alors ',(0,a.jsx)(n.code,{children:"builder.Configuration"})," ira lire dans le fichier ",(0,a.jsx)(n.code,{children:"appsettings.json"})," puis ",(0,a.jsx)(n.code,{children:"appsettings.Development.json"}),', et si la valeur est "Staging", alors il ira lire dans le ',(0,a.jsx)(n.code,{children:"appsettings.json"})," puis ",(0,a.jsx)(n.code,{children:"appsettings.Staging.json"}),"."]}),"\n",(0,a.jsx)(n.p,{children:'Apr\xe8s avoir cr\xe9\xe9 le Dockerfile et build\xe9 l\u2019image de l\u2019API, au moment de lancer l\u2019image, je passe en param\xe8tre la valeur de la variable d\u2019environnement. Par d\xe9faut, dans une image Docker, c\u2019est "Production".'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"docker run -p 8080:80 -e ASPNETCORE_ENVIRONMENT=Staging test\n"})}),"\n",(0,a.jsx)(n.p,{children:"Je v\xe9rifie que tout fonctionne sur ma machine. Si tout est ok, je pousse l\u2019image dans le Container Registry d\u2019Azure, puis je mets \xe0 jour l\u2019image du Container App de l\u2019API."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"az containerapp update `\n    --name $containerAppName `\n    --resource-group $resourceGroupName `\n    --image $imageName `\n    --cpu 0.5 `\n    --memory 1.0Gi `\n    --min-replicas 1 `\n    --max-replicas 2 `\n    --set-env-vars `\n    ASPNETCORE_ENVIRONMENT=Staging `\n    CosmosDB__PrimaryKey=secretref:cosmosdb-primary-key\n"})}),"\n",(0,a.jsx)(n.p,{children:"Si tu as des erreurs de probes dans ton container app v\xe9rifie que ton api expose \u201c/\u201d comme endpoint."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'app.MapGet("/", () => Results.Ok("OK"));\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Et que ton image \xe9coute le port 80. Dans le dockerfile : ",(0,a.jsx)(n.strong,{children:"ENV ASPNETCORE_HTTP_PORTS=80."})]}),"\n",(0,a.jsxs)(n.p,{children:["L\u2019api fonctionne dans l\u2019environnement de \u201cDevelopment\u201d mais \xe9galement en \u201cStaging\u201d. Disponible ici : ",(0,a.jsx)(n.a,{href:"https://ca-rentcrl-api-stg-fc.politewater-4ee63bcd.francecentral.azurecontainerapps.io/scalar/v1#tag/rentcrlweb",children:"https://ca-rentcrl-api-stg-fc.politewater-4ee63bcd.francecentral.azurecontainerapps.io/scalar/v1#tag/rentcrlweb"})]}),"\n",(0,a.jsx)(n.h2,{id:"4-deploiement-de-lapp-sur-azure",children:"4. Deploiement de l\u2019app sur Azure"}),"\n",(0,a.jsxs)(n.p,{children:["Pour l\u2019app, j\u2019utilise React, et contrairement \xe0 ",(0,a.jsx)(n.a,{href:"http://asp.net/",children:"ASP.NET"}),", je n\u2019ai pas trouv\xe9 de gestion des variables d\u2019environnement aussi efficace dans React. C\u2019est pourquoi R\xe9mi C\xe9raline (",(0,a.jsx)(n.a,{href:"https://www.remiceraline.com/",children:"https://www.remiceraline.com"}),") m\u2019a montr\xe9 une approche plut\xf4t int\xe9ressante que je vais partager ici."]}),"\n",(0,a.jsxs)(n.p,{children:["Mon objectif est que les variables d\u2019environnement puissent changer de valeur ",(0,a.jsx)(n.strong,{children:"apr\xe8s"})," le build de l\u2019image, car je veux utiliser la ",(0,a.jsx)(n.strong,{children:"m\xeame image"})," dans l\u2019environnement de d\xe9veloppement, puis dans celui de staging pour les tests, et enfin en production. C\u2019est bien la m\xeame image qui passe par ces trois environnements. Pour le moment, la seule variable qui change selon l\u2019environnement est ",(0,a.jsx)(n.code,{children:"apiBaseUrl"}),", et je veux pouvoir la modifier dans la commande ",(0,a.jsx)(n.code,{children:"update"}),", comme pour l\u2019API, avec cette commande :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"az containerapp update `\n    --name $containerAppName `\n    --resource-group $resourceGroupName `\n    --image $imageName `\n    --cpu 0.5 `\n    --memory 1.0Gi `\n    --min-replicas 1 `\n    --max-replicas 2 `\n    --set-env-vars `\n    API_BASE_URL=https://ca-rentcrl-api-stg-fc.politewater-4ee63bcd.francecentral.azurecontainerapps.io\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Maintenant dans mon application React, dans le dossier ",(0,a.jsx)(n.strong,{children:"public"}),", j\u2019ai cr\xe9\xe9 un dossier ",(0,a.jsx)(n.strong,{children:"config"})," dans lequel je cr\xe9 un fichier env.js et env.template.js."]}),"\n",(0,a.jsxs)(n.p,{children:["Dans mon application React, dans le dossier ",(0,a.jsx)(n.strong,{children:"public"}),", j\u2019ai cr\xe9\xe9 un dossier ",(0,a.jsx)(n.strong,{children:"config"})," dans lequel j\u2019ai mis deux fichiers : ",(0,a.jsx)(n.code,{children:"env.js"})," et ",(0,a.jsx)(n.code,{children:"env.template.js"}),"."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image.png",src:s(6572).A+"",width:"322",height:"102"})}),"\n",(0,a.jsx)(n.h3,{id:"envjs",children:"env.js"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'let globalConfig = {\n  apiBaseUrl: "http://localhost:5047",\n};\n'})}),"\n",(0,a.jsx)(n.h3,{id:"envtemplatejs",children:"env.template.js"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'let globalConfig = {\n  apiBaseUrl: "${API_BASE_URL}",\n};\n'})}),"\n",(0,a.jsxs)(n.p,{children:["J\u2019ai ensuite d\xe9clar\xe9 cette variable pour l\u2019utiliser dans mon app React, qui fonctionne avec TypeScript. Dans le dossier ",(0,a.jsx)(n.strong,{children:"src"}),", j\u2019ai ajout\xe9 un fichier ",(0,a.jsx)(n.strong,{children:"global.d.ts"})," dans lequel j\u2019ai mis :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"declare var globalConfig: {\n  apiBaseUrl: string;\n};\n"})}),"\n",(0,a.jsx)(n.p,{children:"Je remplace alors le code de tout \xe0 l\u2019heure par :"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:'const token = await getAccessTokenSilently();\nawait fetch(`${globalConfig.apiBaseUrl}/owners`, {\n  method: "POST",\n  headers: {\n    "Content-Type": "application/json",\n    Authorization: `Bearer ${token}`,\n  },\n  body: JSON.stringify({ ...owner }),\n});\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\xe0-quoi-\xe7a-sert-",children:"\xc0 quoi \xe7a sert ?"}),"\n",(0,a.jsxs)(n.p,{children:["Quand je build mon image, React cr\xe9e un dossier ",(0,a.jsx)(n.strong,{children:"dist"})," qui contient le ",(0,a.jsx)(n.strong,{children:"bundler"})," avec tous les fichiers r\xe9unis dans un seul gros fichier."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"image.png",src:s(7207).A+"",width:"311",height:"228"})}),"\n",(0,a.jsxs)(n.p,{children:["\xc0 ce moment-l\xe0, il est trop tard pour changer la valeur des variables. Il aurait fallu avoir plusieurs fichiers de variables ou une logique conditionnelle pour choisir la bonne en fonction de l\u2019environnement. \xc0 d\xe9faut, le fichier ",(0,a.jsx)(n.strong,{children:"global.d.ts"})," permet \xe0 TypeScript de comprendre l\u2019objet ",(0,a.jsx)(n.code,{children:"globalConfig"})," qui est d\xe9clar\xe9 dans le dossier ",(0,a.jsx)(n.strong,{children:"public"})," \u2014 donc ",(0,a.jsx)(n.strong,{children:"en dehors"})," du bundler \u2014 et qui se trouve dans le dossier ",(0,a.jsx)(n.strong,{children:"config"})," apr\xe8s le build."]}),"\n",(0,a.jsxs)(n.p,{children:["C\u2019est ce qui me permet de ",(0,a.jsx)(n.strong,{children:"r\xe9\xe9crire sa valeur dans le Dockerfile"})," avant de lancer l\u2019app gr\xe2ce \xe0 la commande ",(0,a.jsx)(n.code,{children:"envsubst"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Voici la ligne qui permet de mettre \xe0 jour ",(0,a.jsx)(n.code,{children:"env.template.js"})," :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"  API_BASE_URL=https://ca-rentcrl-api-stg-fc.politewater-4ee63bcd.francecentral.azurecontainerapps.io\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Puis je remplace le contenu de ",(0,a.jsx)(n.code,{children:"env.js"})," par celui de ",(0,a.jsx)(n.code,{children:"env.template.js"})," avec la commande ",(0,a.jsx)(n.code,{children:"envsubst"})," :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:'CMD ["/bin/sh", "-c", "envsubst < /usr/share/nginx/html/config/env.template.js > /usr/share/nginx/html/config/env.js && nginx -g \'daemon off;\'"]\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Bien s\xfbr il ne faut pas oublier d\u2019importer la variable dans le ",(0,a.jsx)(n.strong,{children:"index.html"})," avant le ",(0,a.jsx)(n.strong,{children:"main.tsx"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",children:'<body>\n  <script type="text/javascript" src="/config/env.js"><\/script>\n  <div id="root"></div>\n\n  <script>\n    console.log(globalConfig);\n  <\/script>\n\n  <script type="module" src="/src/main.tsx"><\/script>\n</body>\n'})}),"\n",(0,a.jsx)(n.p,{children:"Avec tout \xe7a, je peux mettre \xe0 jour le container app et sp\xe9cifier l\u2019environnement simplement."}),"\n",(0,a.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,a.jsx)(n.p,{children:"En suivant cette approche, j'ai pu :"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"S\xe9parer les configurations"})," selon les environnements, ce qui facilite le d\xe9ploiement et la maintenance."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"S\xe9curiser les secrets"})," en utilisant Azure Key Vault."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Automatiser le d\xe9ploiement"})," du frontend et du backend avec Azure Container Apps."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["\ud83d\udcc1 Code source ici : ",(0,a.jsx)(n.a,{href:"https://github.com/MickaelCRL/RentCRL",children:"https://github.com/MickaelCRL/RentCRL"})]}),"\n",(0,a.jsx)(n.p,{children:"N'h\xe9sitez pas \xe0 me faire part de vos retours ou de vos questions !"})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);